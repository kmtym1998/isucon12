# チューニングの基礎知識

- Core Web Vitals
  - Google が SEO に使っている指標のひとつ
  - ページエクスペリエンスがいかに優れているか
  - LCP: Largest Contentful Paint
  - FID: First Input Delay
  - CLS: Cumulative Layout Shift
- Web サービスを高速化する = レイテンシを低くする
- RTT (Round Trip Time): リクエスト送信開始~レスポンス受信完了までの長さ
- スループット
  - 同時並行で行われるリクエストを少ないリソースで処理する
  - 単位は rps (Requests Per Second) - RPS の出し方は TPO
    <img width="688" alt="image" src="https://user-images.githubusercontent.com/54347899/178095047-9c6e5d6d-b2be-4d6d-8d15-675ac8143924.png">
- サービスの負荷が高い状態 = システムリソース農地、時間流動性が高いシステムリソースの利用率が高いこと
  - 時間流動性: 短時間で利用量が大きく変わること
    - 時間流動性が高いリソースの例: CPU 時間、メモリ領域、メモリ I/O、ネットワーク I/O、ストレージ I/O
  - リクエストを処理している = リソースを専有している
  - リクエストのレイテンシを低くする = リソースの専有時間が短くなる
    - rps が 1000 で 1000msec だった処理が 500msec になると、必要な並列性能は 1000 並列 → 500 並列に！
- 垂直スケーリング: サーバの性能を上げる
- 水平スケーリング: サーバの台数を増やす
- パフォーマンスチューニングの基本
  - いきなり手を動かさない
  - 勘で行動しない。推測するな、計測せよ
  - ボトルネックにだけアプローチする。ボトルネック以外にアプローチしても、逆効果になることも
  - ボトルネック対処
    - 解決：課題になっている事象を根本から解決する
    - 回避：課題になっている事象がボトルネックにならないよう迂回・省略する
    - 緩和：課題になっている事象の影響を和らげる
  - 緩和をするのは解決と回避ができないとき
  - 負荷テストをしよう
  - 負荷テスト計画を立てよう
